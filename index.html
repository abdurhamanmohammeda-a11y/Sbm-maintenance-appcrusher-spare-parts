<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SBM Maintenance App</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root{ --primary:#39FF14; --bg:#0f1117; --card:#1c1f26; --text:#e6edf3; --accent:#FFA500; }
        body{ margin:0; background:var(--bg); color:var(--text); font-family:'Roboto',sans-serif; }
        header{ text-align:center; padding:20px; background:linear-gradient(180deg, var(--primary), #111); border-radius:0 0 20px 20px; color:#000; }
        .container{ max-width:600px; margin:auto; padding:15px; }
        .card{ background:var(--card); padding:15px; border-radius:12px; margin:15px 0; border:1px solid #30363d; }
        h2{ color:var(--primary); font-size:16px; margin-top:0; border-bottom:1px solid #333; padding-bottom:5px; }
        input,select,textarea,button{ width:100%; padding:12px; margin:8px 0; border-radius:8px; border:none; box-sizing:border-box; }
        input, select, textarea { background:#0d1117; color:white; border:1px solid #444; }
        button{ background:var(--primary); font-weight:bold; cursor:pointer; color:#000; }
        .dashboard-item{ border-bottom:1px solid #333; padding:10px 0; display:flex; justify-content:space-between; align-items:center; }
        .btn-delete { background:#ff4444; color:white; width:auto; padding:5px 10px; font-size:12px; }
        .whatsapp{ position:fixed; bottom:20px; right:20px; }
    </style>
</head>
<body>

<header>
    <h1 style="font-family:'Orbitron'; font-size:18px; margin:0;">ABDURHAMAN MECHATRONICS</h1>
    <p style="margin:5px 0 0; font-size:12px;">SBM Specialist | Cloud Integrated</p>
</header>

<div class="container">
    <div class="card" style="padding:0; overflow:hidden;">
        <img src="https://www.sbmchina.com/d/pic/products/crusher/pe-jaw-crusher.jpg" style="width:100%; display:block;">
    </div>

    <div class="card">
        <h2>ðŸ“Š New Maintenance Report</h2>
        <input type="text" id="customer" placeholder="Customer Name">
        <select id="machine">
            <option value="">Select Machine</option>
            <option>Jaw Crusher</option>
            <option>Cone Crusher</option>
            <option>SBM Screen</option>
        </select>
        <textarea id="issue" placeholder="Fault Description"></textarea>
        <button onclick="saveReport()">SEND TO CLOUD</button>
    </div>

    <div class="card">
        <h2>ðŸ“ˆ Live Dashboard (Real-time)</h2>
        <div id="reportList"></div>
    </div>
</div>

<a href="https://wa.me/251904267186" class="whatsapp" target="_blank">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" width="50">
</a>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyC1_0Ptpna4V-2cfyJHNwIvWvbA2eGLv18",
        authDomain: "sbm-app-ecf59.firebaseapp.com",
        projectId: "sbm-app-ecf59",
        storageBucket: "sbm-app-ecf59.firebasestorage.app",
        messagingSenderId: "666387083873",
        appId: "1:666387083873:web:bfd6d5e064ecaad6c73020"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function saveReport(){
        const customer = document.getElementById("customer").value;
        const machine = document.getElementById("machine").value;
        const issue = document.getElementById("issue").value;
        if(!customer || !machine || !issue) { alert("Fill all fields"); return; }

        db.collection("reports").add({
            customer: customer,
            machine: machine,
            issue: issue,
            time: firebase.firestore.FieldValue.serverTimestamp()
        }).then(() => {
            alert("Success âœ…");
            document.getElementById("customer").value = "";
            document.getElementById("issue").value = "";
        });
    }

    // Real-time listener for dashboard
    db.collection("reports").orderBy("time", "desc").onSnapshot(snapshot => {
        const list = document.getElementById("reportList");
        list.innerHTML = "";
        snapshot.forEach(doc => {
            const data = doc.data();
            list.innerHTML += `
                <div class="dashboard-item">
                    <div><strong>${data.customer}</strong><br><small>${data.machine}</small></div>
                    <button class="btn-delete" onclick="deleteDoc('${doc.id}')">Delete</button>
                </div>`;
        });
    });

    function deleteDoc(id){
        if(confirm("Delete report?")) { db.collection("reports").doc(id).delete(); }
    }
</script>
</body>
</html>

